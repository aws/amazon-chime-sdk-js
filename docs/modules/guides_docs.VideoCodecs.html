<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>VideoCodecs | amazon-chime-sdk-js</title><meta name="description" content="Documentation for amazon-chime-sdk-js"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">amazon-chime-sdk-js</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">amazon-chime-sdk-js</a></li><li><a href="guides_docs.html">guides/docs</a></li><li><a href="guides_docs.VideoCodecs.html">VideoCodecs</a></li></ul><h1>Namespace VideoCodecs</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><a id="managing-video-codecs-in-meetings" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Managing Video Codecs in Meetings<a href="#managing-video-codecs-in-meetings" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><ul>
<li><a href="#managing-video-codecs-in-meetings">Managing Video Codecs in Meetings</a>
<ul>
<li><a href="#setting-video-send-codec-preferences">Setting Video Send Codec Preferences</a></li>
<li><a href="#considerations-for-adjusting-video-send-codec-defaults">Considerations for Adjusting Video Send Codec Defaults</a>
<ul>
<li><a href="#hardware-vs-software-codecs">Hardware vs. Software Codecs</a></li>
<li><a href="#browserdevice-support">Browser/Device Support</a>
<ul>
<li><a href="#avoiding-browserdevice-specific-bugs">Avoiding Browser/Device Specific Bugs</a></li>
</ul>
</li>
<li><a href="#batterycpu-usage">Battery/CPU Usage</a></li>
<li><a href="#bandwidth-usage--general-performance">Bandwidth Usage &amp; General Performance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>After raw video frames are captured (e.g. from a camera outputting an RGBA pixel matrix) they are <em>encoded</em> before being sent on the network to reduce their size. On the receiving end, they are <em>decoded</em> back to raw data before being displayed or recorded. The pattern is similar to compression and decompression patterns in, for example, <code>.zip</code> files, however in the realm of media, these <em>codecs</em> (a portmanteau of <em>encoder</em> and <em>decoder</em>) are heavily specialized to audio or video, and the choice of codec can dramatically effect end user experience and the features of your application.</p>
<p>The Amazon Chime SDK for Javascript supports setting a list of video codec preferences which will be used to select the encoder for an individual client. The API allows setting fallback codecs to, if desired, ensure that all participants in the call can receive video from senders as long as there is some intersection between the chosen codecs and the receive capabilities. This document will cover how to use the API, its effects, and some possible use cases for using it.</p>
<a id="setting-video-send-codec-preferences" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Setting Video Send Codec Preferences<a href="#setting-video-send-codec-preferences" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Application builders can use <a href="https://aws.github.io/amazon-chime-sdk-js/interfaces/audiovideocontrollerfacade.html#setvideocodecsendpreferences"><code>AudioVideoControllerFacade.setVideoCodecSendPreferences</code></a> for control over video send codecs. The fallback behavior is indicated in the documentation and can be made clear with a few examples. Not calling this function is functionally equivalent to the following:</p>
<pre><code><span class="hl-7">// Assumes a meeting session has already been created and stored in `this.meetingSession`</span><br/><br/><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">meetingSession</span><span class="hl-1">.</span><span class="hl-0">audioVideo</span><span class="hl-1">.</span><span class="hl-6">setVideoCodecSendPreferences</span><span class="hl-1">([</span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">h264</span><span class="hl-1">()]);</span>
</code><button>Copy</button></pre>

<p>This implies the following:</p>
<ul>
<li>Ignoring other restrictions, the sending client will transmit video into the meeting using the H.264 video codec.</li>
<li>The sending client <em>will not</em> fallback to any other codec if another attendee joins without an H.264 decoder (which may occur on some browsers, see notes below). That receiving attendee will not receive this video.</li>
<li>If the sending client does not support encoding H.264, then it will fall back to any video codec that the browser supports (even though it wasn't set via <code>setVideoCodecSendPreferences</code>), that is also supported by the meeting (currently this meeting level configuration is not exposed). As meetings at this time support only H.264 CBP and VP8, that means the client would fall back to VP8.</li>
</ul>
<p>For more complex fallback behavior, consider the following example:</p>
<pre><code><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">meetingSession</span><span class="hl-1">.</span><span class="hl-0">audioVideo</span><span class="hl-1">.</span><span class="hl-6">setVideoCodecSendPreferences</span><span class="hl-1">([</span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">h264</span><span class="hl-1">(), </span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">vp8</span><span class="hl-1">()]);</span>
</code><button>Copy</button></pre>

<p>This implies the following:</p>
<ul>
<li>Ignoring other restrictions, the sending client will transmit video into the meeting using the H.264 video codec.</li>
<li>The sending client <em>will</em> fallback to VP8 other codec if another attendee joins with H.264 decode support, but does have VP8 decode support.</li>
<li>If the sending client does not support encoding H.264, then it will fall back to VP8 (not technically a change in behavior, but will be more relevant when accounting for additional codecs).</li>
</ul>
<p>A similar API <a href="https://aws.github.io/amazon-chime-sdk-js/interfaces/contentsharecontrollerfacade.html#setcontentsharevideocodecpreferences"><code>ContentShareControllerFacade.setContentShareVideoCodecPreferences</code></a> exists to control content share video send codecs and it is used in identical fashion, e.g.:</p>
<pre><code><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">meetingSession</span><span class="hl-1">.</span><span class="hl-0">audioVideo</span><span class="hl-1">.</span><span class="hl-6">setContentShareVideoCodecPreferences</span><span class="hl-1">([</span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">h264</span><span class="hl-1">(), </span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">vp8</span><span class="hl-1">()]);</span>
</code><button>Copy</button></pre>

<a id="considerations-for-adjusting-video-send-codec-defaults" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Considerations for Adjusting Video Send Codec Defaults<a href="#considerations-for-adjusting-video-send-codec-defaults" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The default behavior in the Amazon Chime SDK client libraries noted above is chosen to minimize CPU and maintain backwards compatible behavior. However, depending on your applications use case, you may wish to adjust from the defaults to best fit your end-users. This section will cover various impacts of that choice which should be considered.</p>
<a id="hardware-vs-software-codecs" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Hardware vs. Software Codecs<a href="#hardware-vs-software-codecs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Video codecs can be implemented one of two ways:</p>
<ul>
<li>Software codecs are written in user space code and ran on CPU, incurring higher CPU and battery usage, but generally being more stable. Usage of software codecs is often limited due to licensing, depending on the codec used.</li>
<li>Hardware codecs are ran on specialized physical components (i.e. <em>not</em> on CPU), which generally limit CPU requirements and battery usage. Often the licensing of codecs is offloaded to the device manufacture.</li>
</ul>
<p>Note that while a <em>codec</em> refers to both encoding and decoding, the implementation doesn't need to be coupled. For example a client may encode using a software encoder, but decode using a hardware encoder. Similarily there are various implementations, both software and hardware, for any given codec. The codec specification ensures that these implementations are interoperable.</p>
<a id="browserdevice-support" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Browser/Device Support<a href="#browserdevice-support" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Not all browsers support all codecs. In particular H.264 support is often dependent on the existance of hardware support. Given that VP8 and H.264 are generally widely available, we can instead call out a few use cases where H.264 is not supported:</p>
<ul>
<li>Some older Android devices do not have hardware H.264 codecs and therefore will not be able to encode or decode H.264.</li>
<li>Some custom or old Chrome builds may not have H.264 enabled.</li>
</ul>
<p>If your application encounters significant end-user issues with not being able to receive H.264 (which will currently be replaced by a static VP8 video stream with an error message), you may want to consider calling <a href="https://aws.github.io/amazon-chime-sdk-js/interfaces/audiovideocontrollerfacade.html#setvideocodecsendpreferences"><code>setVideoCodecSendPreferences</code></a> with either VP8 only or VP8 as a fallback.</p>
<a id="avoiding-browserdevice-specific-bugs" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Avoiding Browser/Device Specific Bugs<a href="#avoiding-browserdevice-specific-bugs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Occasionally, Browser or OS updates (particularily on mobile) may bring along bugs and issues related to specific codecs (particularily when hardware is in use). In this case, you may not want to wait on JS SDK versions to manually change the default send codec. For example, if you detect that iOS clients are sending significantly lower bitrates then expected, it may be due to a recent release impacting hardware encoders. For example, builders can temporarily use only VP8 for iOS Safari clients:</p>
<pre><code><span class="hl-2">if</span><span class="hl-1"> (</span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">DefaultBrowserBehavior</span><span class="hl-1">().</span><span class="hl-6">isIOSSafari</span><span class="hl-1">()) {</span><br/><span class="hl-1">  </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">meetingSession</span><span class="hl-1">.</span><span class="hl-0">audioVideo</span><span class="hl-1">.</span><span class="hl-6">setVideoCodecSendPreferences</span><span class="hl-1">([</span><span class="hl-0">VideoCodecCapability</span><span class="hl-1">.</span><span class="hl-6">vp8</span><span class="hl-1">()]);</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>

<p>If you suspect issues with a given codec/device/browser combination, please cut a Github issue so Amazon Chime SDK developers can investigate and provide guidance.</p>
<a id="batterycpu-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Battery/CPU Usage<a href="#batterycpu-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>As mentioned above, hardware codecs generally require less CPU and battery load. Therefore application builders should acknoledge that there will be, for example, marginally worse battery life for clients which they switch to send VP8, which is usually using software implementations. This effects the receive side as well, a switch to VP8 is more impactful to applications which receive and display a significant amount of remote videos.</p>
<a id="bandwidth-usage--general-performance" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Bandwidth Usage &amp; General Performance<a href="#bandwidth-usage--general-performance" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>VP8 and H.264 perform similarily from an end-user experience in terms of video quality for a given bitrate. Therefore ignoring browser/device specific bugs, video quality should not likely be a factor in the choice to pick a specific video codec to send.</p>
<p><a href="https://github.com/aws/amazon-chime-sdk-js/issues/new?assignees=&amp;labels=documentation&amp;template=documentation-request.md&amp;title=Video%20Codecs%20feedback">Give feedback on this guide</a></p>
</div><div class="tsd-comment tsd-typography"></div></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#managing-video-codecs-in-meetings"><span>Managing <wbr/>Video <wbr/>Codecs in <wbr/>Meetings</span></a><ul><li><a href="#setting-video-send-codec-preferences"><span>Setting <wbr/>Video <wbr/>Send <wbr/>Codec <wbr/>Preferences</span></a></li><li><a href="#considerations-for-adjusting-video-send-codec-defaults"><span>Considerations for <wbr/>Adjusting <wbr/>Video <wbr/>Send <wbr/>Codec <wbr/>Defaults</span></a></li><li><ul><li><ul><li><a href="#hardware-vs-software-codecs"><span>Hardware vs. <wbr/>Software <wbr/>Codecs</span></a></li></ul></li><li><a href="#browserdevice-support"><span>Browser/<wbr/>Device <wbr/>Support</span></a></li><li><ul><li><a href="#avoiding-browserdevice-specific-bugs"><span>Avoiding <wbr/>Browser/<wbr/>Device <wbr/>Specific <wbr/>Bugs</span></a></li></ul></li><li><a href="#batterycpu-usage"><span>Battery/CPU <wbr/>Usage</span></a></li><li><a href="#bandwidth-usage--general-performance"><span>Bandwidth <wbr/>Usage &amp; <wbr/>General <wbr/>Performance</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">amazon-chime-sdk-js</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
